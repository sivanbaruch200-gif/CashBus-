# ×¡×™×›×•× MVP - ××¢×¨×›×ª GYRO ×”×•×©×œ××”! ğŸ‰

## ××” ×”×•×©×œ× ×”×™×•×?

### 1. âœ… ×©×“×¨×•×’ PDF Generator ×”××©×¤×˜×™

**×§×•×‘×¥:** `lib/pdfGenerator.ts`

**×©×™×¤×•×¨×™×:**
- âœ… ×ª×§× ×•×ª ×¡×¤×¦×™×¤×™×•×ª ×œ×¤×™ ×¡×•×’ ××™×¨×•×¢:
  - ××™-×¢×¦×™×¨×”: ×ª×§× ×•×ª 428(×’), 385×, 430
  - ××™-×”×’×¢×”/××™×—×•×¨: ×ª×§× ×•×ª 399(×), 400(×)
  - ×™×—×¡ ×•×¨×©×œ× ×•×ª: ×ª×§× ×•×ª 416(×), 416(×‘), 419

- âœ… × ×™×¡×•×—×™× ××©×¤×˜×™×™× ×× ×¦×—×™×:
  - ×¦×™×˜×•×˜ ×¤×¡×™×§×” (×ª"×§ 32995-02-14)
  - ×‘×¡×™×¡ ××©×¤×˜×™ ××¤×•×¨×˜ ×œ×›×œ ×¡×•×’ ××™×¨×•×¢
  - × ×¡×¤×— ×¨××™×•×ª ×“×™×’×™×˜×œ×™ (GPS + SIRI)

- âœ… ×©×™× ×•×™ ×œ-14 ×™××™×:
  - ×¢×“×›×•×Ÿ ×”×•×“×¢×ª "×ª×•×š 14 ×™××™× ×××•×¢×“ ×§×‘×œ×ª ××›×ª×‘ ×–×”"
  - ××–×”×¨×” ×¢×œ ×¡×“×¨×ª ×ª×–×›×•×¨×•×ª ××•×˜×•××˜×™×•×ª
  - ×—×ª×™××” ××©×¤×˜×™×ª: "××›×ª×‘ ×–×” ××”×•×•×” ×”×ª×¨××” ×¨×©××™×ª"

- âœ… ×”×•×¡×¤×ª ×©×“×•×ª ×—×“×©×™×:
  - `gpsAccuracy` - ×“×™×•×§ GPS ×‘××˜×¨×™×
  - `siriVerified` - ××™××•×ª ××•×œ SIRI
  - `receipts` - URLs ×©×œ ×§×‘×œ×•×ª
  - `customerId` - ×ª.×– (×—×•×‘×”)

---

### 2. âœ… ×ª×©×ª×™×ª Database ×œ××¢×¨×›×ª GYRO

**×§×•×‘×¥:** `supabase/migrations/add_reminder_system.sql`

**×˜×‘×œ××•×ª ×—×“×©×•×ª:**

#### `letter_reminders` - ××¢×§×‘ ××—×¨ ××›×ª×‘×™× ×•×ª×–×›×•×¨×•×ª
```sql
- claim_id, user_id
- initial_letter_sent_at
- days_since_initial (auto-calculated)
- day_2_sent, day_5_sent, day_8_sent, day_11_sent, day_12_sent, day_13_sent, day_14_sent
- status: active | paid | cancelled | filed
- total_emails_sent, last_email_sent_at
- company_responded, company_response_date
```

**×¤×•× ×§×¦×™×•×ª ×—×“×©×•×ª:**

1. `get_pending_reminders()` - ××—×–×™×¨ ×¨×©×™××ª ×ª×–×›×•×¨×•×ª ×××ª×™× ×•×ª
2. `mark_reminder_sent()` - ××¡××Ÿ ×ª×–×›×•×¨×ª ×›× ×©×œ×—×”
3. `calculate_days_since_initial()` - ×—×™×©×•×‘ ××•×˜×•××˜×™ ×©×œ ×™××™× ×××– ×©×œ×™×—×”

**×¢×“×›×•× ×™× ×œ×˜×‘×œ×” ×§×™×™××ª:**

`legal_documents`:
- `letter_sequence` - 0=initial, 1-7=reminders
- `reminder_type` - ×¡×•×’ ×”×ª×–×›×•×¨×ª

---

### 3. âœ… Edge Function ×œ×©×œ×™×—×ª ×ª×–×›×•×¨×•×ª

**×§×•×‘×¥:** `supabase/functions/send-reminders/index.ts`

**×™×›×•×œ×•×ª:**
- âœ… ××©×™×›×ª ×ª×‘×™×¢×•×ª ×¤×¢×™×œ×•×ª ×“×¨×š `get_pending_reminders()`
- âœ… 7 ×ª×‘× ×™×•×ª email ×©×•× ×•×ª (×™×•× 2, 5, 8, 11, 12, 13, 14)
- âœ… ×©×œ×™×—×” ×“×¨×š Resend API
- âœ… BCC ××•×˜×•××˜×™ ×œ×—×‘×¨×” + ××©×¨×“ ×”×ª×—×‘×•×¨×” (`Pniotcrm@mot.gov.il`)
- âœ… ×¢×™×¦×•×‘ RTL Hebrew ××œ×
- âœ… ×¡×¤×™×¨×” ×œ××—×•×¨ ×“×™× ××™×ª
- âœ… ×”×ª×¨××•×ª ××“×•×¨×’×•×ª (×™×¨×•×§ â†’ ×›×ª×•× â†’ ××“×•×)

**×ª×‘× ×™×•×ª Email:**

| ×™×•× | × ×•×©× | ×¦×‘×¢ | ×ª×•×›×Ÿ ×¢×™×§×¨×™ |
|-----|------|-----|-----------|
| 2 | ×‘×“×™×§×ª ×¡×˜×˜×•×¡ | ×›×—×•×œ | "×˜×¨× ×”×ª×§×‘×œ ××™×©×•×¨ ×§×‘×œ×”" |
| 5 | ×”×ª×¨××” ×©× ×™×™×” + ×¨××™×•×ª | ×›×—×•×œ | × ×¡×¤×— ×¨××™×•×ª ×“×™×’×™×˜×œ×™ ××œ× |
| 8 | ×”×¡×œ××” ××©×¤×˜×™×ª | ×›×ª×•× | "×”×ª×™×§ ×”×•×¢×‘×¨ ×œ×”×›× ×ª ×›×ª×‘ ×ª×‘×™×¢×”" |
| 11 | ×”×ª×¨××” ××—×¨×•× ×” | ××“×•× | "× ×•×ª×¨×• 3 ×™××™×" |
| 12-13 | ×œ×—×¥ ×™×•××™ | ××“×•× | ×¡×¤×™×¨×” ×œ××—×•×¨ |
| 14 | ×›×ª×‘ ×ª×‘×™×¢×” ××•×›×Ÿ | ××“×•× ×›×”×” | "××•×›×Ÿ ×œ×”×’×©×” ×‘× ×˜-×”××©×¤×˜" |

**Cron Setup:**
```sql
SELECT cron.schedule(
  'send-daily-reminders',
  '0 9 * * *',  -- 9:00 AM daily
  ...
);
```

---

### 4. âœ… ×××©×§ Admin Queue

**×§×•×‘×¥:** `app/admin/letter-queue/page.tsx`

**×ª×›×•× ×•×ª:**
- âœ… ×ª×¦×•×’×ª ×˜×‘×œ×” ×©×œ ×›×œ ×”×ª×‘×™×¢×•×ª
- âœ… 4 ×¡×˜×˜×™×¡×˜×™×§×•×ª ××¨×›×–×™×•×ª:
  - ×¡×”"×› ×ª×‘×™×¢×•×ª
  - ×××ª×™× ×•×ª ×œ×©×œ×™×—×”
  - ×‘××¢×§×‘ ×¤×¢×™×œ
  - ×“×•×¨×©×•×ª ×ª×©×•××ª ×œ×‘

- âœ… ××•× ×” ×™××™× × ×•×ª×¨×™× ×¢× ×¦×‘×¢×™×:
  - ×™×¨×•×§: 8-14 ×™××™×
  - ×›×ª×•×: 4-7 ×™××™×
  - ××“×•×: 1-3 ×™××™×

- âœ… ×¤×¢×•×œ×•×ª ×œ×›×œ ×ª×‘×™×¢×”:
  - ğŸ“„ ×”×¦×’ PDF - preview ×©×œ ×”××›×ª×‘
  - ğŸ“§ ××©×¨ ×©×œ×™×—×” - ×©×œ×™×—×ª ××›×ª×‘ ×¨××©×•× ×™ ×•×”×¤×¢×œ×ª GYRO
  - âš–ï¸ ×›×ª×‘ ×ª×‘×™×¢×” - ×œ×™×•× 14

- âœ… ×¢×™×¦×•×‘ RTL ××œ×
- âœ… Responsive design
- âœ… Real-time updates

---

### 5. âœ… Generator ×œ×›×ª×‘ ×ª×‘×™×¢×” (×™×•× 14)

**×§×•×‘×¥:** `lib/lawsuitGenerator.ts`

**××‘× ×” ×”××¡××š:**

#### ×¡×¢×™×¤×™×:
1. **×‘×™×ª ×”××©×¤×˜** - ×¤×¨×˜×™ ×‘×™×ª ××©×¤×˜ ×œ×ª×‘×™×¢×•×ª ×§×˜× ×•×ª
2. **×”×¦×“×“×™×** - ×ª×•×‘×¢ (×œ×§×•×—) + × ×ª×‘×¢ (×—×‘×¨×ª ××•×˜×•×‘×•×¡×™×)
3. **×. ×”×§×“××”** - ×¡×›×•× ×ª×‘×™×¢×” + ×‘×¡×™×¡ ×—×•×§×™
4. **×‘. ×”×¢×•×‘×“×•×ª** - ×ª×™××•×¨ ××¤×•×¨×˜ ×©×œ ×”××™×¨×•×¢ + timeline
5. **×’. ×”×‘×¡×™×¡ ×”××©×¤×˜×™** - ×ª×§× ×•×ª + ×¤×¡×™×§×”
6. **×“. ×¤×™×¨×•×˜ × ×–×§×™×** - breakdown ××œ×:
   - ×”×•×¦××•×ª ×™×©×™×¨×•×ª (×§×‘×œ×•×ª)
   - ×¤×™×¦×•×™ ×‘×¡×™×¡ + ×¢×’××ª × ×¤×©
   - ×”×•×¦××•×ª ××©×¤×˜
   - **×¡×”"×›**
7. **×”. ×”×¡×¢×“ ×”××‘×•×§×©** - ×“×¨×™×©×•×ª ××”× ×ª×‘×¢
8. **×•. ×¨××™×•×ª** - ×¨×©×™××ª ×¨××™×•×ª ×“×™×’×™×˜×œ×™×•×ª
9. **×—×ª×™××”** - ×—×ª×™××ª ×”×ª×•×‘×¢ + ×ª××¨×™×š

**××•×›×Ÿ ×œ×”×’×©×”:**
- âœ… ×¤×•×¨××˜ A4 ×œ×”×“×¤×¡×”
- âœ… RTL ××œ×
- âœ… ×¢×™×¦×•×‘ ×¤×•×¨××œ×™
- âœ… ××¡×¤×¨ ×ª×‘×™×¢×” ×‘×ª×—×ª×™×ª
- âœ… ×©×“×” ×œ×—×ª×™××”

---

## ×§×‘×¦×™× ×©× ×•×¦×¨×•/×¢×•×“×›× ×•

### ×§×‘×¦×™× ×—×“×©×™×:
1. `supabase/migrations/add_reminder_system.sql` - DB schema
2. `supabase/functions/send-reminders/index.ts` - Edge Function
3. `supabase/functions/send-reminders/README.md` - ×”×•×¨××•×ª ×“×™×¤×œ×•×™
4. `app/admin/letter-queue/page.tsx` - ×××©×§ Admin
5. `lib/lawsuitGenerator.ts` - PDF ×›×ª×‘ ×ª×‘×™×¢×”
6. `GYRO_DEPLOYMENT_GUIDE.md` - ××“×¨×™×š ×“×™×¤×œ×•×™ ××œ×
7. `MVP_GYRO_SUMMARY.md` - ×¡×™×›×•× ×–×”

### ×§×‘×¦×™× ××¢×•×“×›× ×™×:
1. `lib/pdfGenerator.ts` - ×©×“×¨×•×’ ××©×¤×˜×™ ××œ×

---

## ×”×¦×¢×“×™× ×”×‘××™× (Deployment)

### ×©×œ×‘ 1: Database
```bash
cd "c:\Users\sivan\OneDrive\Desktop\CashBus- Project"
supabase db push
```

### ×©×œ×‘ 2: Edge Function
```bash
# Set secret
supabase secrets set RESEND_API_KEY=re_xxxxxxxxxx

# Deploy
supabase functions deploy send-reminders --no-verify-jwt
```

### ×©×œ×‘ 3: Cron Job
```sql
-- ×‘-Supabase Dashboard > SQL Editor
SELECT cron.schedule(
  'send-daily-reminders',
  '0 9 * * *',
  $$...$$  -- ×¨××” GYRO_DEPLOYMENT_GUIDE.md
);
```

### ×©×œ×‘ 4: Test
```bash
# Manual trigger
curl -X POST \
  https://YOUR_PROJECT_REF.supabase.co/functions/v1/send-reminders \
  -H "Authorization: Bearer YOUR_SERVICE_ROLE_KEY"
```

### ×©×œ×‘ 5: Access Admin Queue
```
http://localhost:3000/admin/letter-queue
```

---

## Statistics

### ×§×•×“ ×©× ×›×ª×‘:
- **7 ×§×‘×¦×™× ×—×“×©×™×**
- **1 ×§×•×‘×¥ ××¢×•×“×›×Ÿ**
- **~2,500 ×©×•×¨×•×ª ×§×•×“**

### ×ª×›×•× ×•×ª:
- âœ… PDF Generator ××©×¤×˜×™ ××ª×§×“×
- âœ… 14-Day automated reminder loop
- âœ… 7 ×ª×‘× ×™×•×ª email ××•×ª×××•×ª ××™×©×™×ª
- âœ… Admin Queue UI
- âœ… Lawsuit PDF generator
- âœ… Database schema ××œ×
- âœ… Edge Function automation
- âœ… Cron scheduling

---

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CashBus GYRO                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Admin UI  â”‚â”€â”€â”€â”€â”€â–¶â”‚ Letter Queue â”‚â”€â”€â”€â”€â”€â–¶â”‚ Resend  â”‚
â”‚ (Next.js)   â”‚      â”‚  Management  â”‚      â”‚   API   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                    â”‚
       â”‚                     â–¼                    â”‚
       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Supabase DB     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ - letter_reminders        â”‚
                    â”‚ - claims                  â”‚
                    â”‚ - legal_documents         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚  â–²
                           â”‚  â”‚
                           â–¼  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Edge Function   â”‚
                    â”‚ (send-reminders)â”‚
                    â”‚                 â”‚
                    â”‚ â° Cron: 9 AM   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Email Flow     â”‚
                    â”‚                 â”‚
                    â”‚ Day 2 â†’ Status  â”‚
                    â”‚ Day 5 â†’ Evidenceâ”‚
                    â”‚ Day 8 â†’ Legal   â”‚
                    â”‚ Day 11â†’ Final   â”‚
                    â”‚ Day 12â†’ Pressureâ”‚
                    â”‚ Day 13â†’ Pressureâ”‚
                    â”‚ Day 14â†’ Lawsuit â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Success Metrics

××—×¨×™ ×”×¤×¢×œ×ª ×”××¢×¨×›×ª, ×¢×§×•×‘ ××—×¨:

1. **Conversion Rate** - % ×—×‘×¨×•×ª ×©×©×™×œ××• ×œ×¤× ×™ ×™×•× 14
2. **Response Time** - ×××•×¦×¢ ×™××™× ×¢×“ ×ª×©×•×‘×” ××”×—×‘×¨×”
3. **Email Open Rate** - % ×¤×ª×™×—×ª ××™×™×œ×™× (Resend analytics)
4. **Day 14 Rate** - % ×ª×‘×™×¢×•×ª ×©×”×’×™×¢×• ×œ×›×ª×‘ ×ª×‘×™×¢×”
5. **Settlement Amount** - ×××•×¦×¢ ×¡×›×•× ×¤×™×¦×•×™ ×©×”×ª×§×‘×œ

---

## âœ¨ ×”×‘×: Phase 4 - AI Legal Letters

×œ××—×¨ ×”×©×§×ª GYRO, ×”××©×š ×œ:
- GPT-4 generation ×©×œ ××›×ª×‘×™× ××•×ª×××™× ××™×©×™×ª
- AI analysis ×©×œ ×ª×©×•×‘×•×ª ××”×—×‘×¨×”
- Auto-negotiation logic
- Sentiment analysis ×©×œ ××™×™×œ×™×

---

**×ª××¨×™×š:** 2026-01-15
**×’×¨×¡×”:** MVP 1.0
**×¡×˜×˜×•×¡:** âœ… ××•×›×Ÿ ×œ×“×™×¤×œ×•×™

---

**Built with â¤ï¸ and âš–ï¸ by CashBus**
